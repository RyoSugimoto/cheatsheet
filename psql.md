# 🧠 PostgreSQL CLI（psql）チートシート

## 🔹 接続・終了系

| コマンド | 説明 |
|-----------|------|
| `psql -U ユーザー名 -d データベース名` | データベースに接続 |
| `psql -h ホスト -p ポート -U ユーザー名 -d データベース名` | リモートDBに接続 |
| `\q` | psql を終了する |
| `\c データベース名` | 別のデータベースに接続（`connect` の略） |

---

## 🔹 データベース操作

| コマンド | 説明 |
|-----------|------|
| `\l` | データベース一覧を表示 (`\list` と同じ) |
| `CREATE DATABASE dbname;` | 新しいデータベースを作成 |
| `DROP DATABASE dbname;` | データベースを削除 |

---

## 🔹 テーブル関連

| コマンド | 説明 |
|-----------|------|
| `\dt` | 現在のスキーマ内のテーブル一覧を表示 |
| `\dt スキーマ名.*` | 特定スキーマのテーブル一覧 |
| `\d テーブル名` | テーブル構造（カラム・制約など）を表示 |
| `\d+ テーブル名` | テーブル詳細（サイズやコメント含む）を表示 |
| `CREATE TABLE table_name (...);` | テーブル作成 |
| `DROP TABLE table_name;` | テーブル削除 |

---

## 🔹 スキーマ・その他オブジェクト

| コマンド | 説明 |
|-----------|------|
| `\dn` | スキーマ一覧 |
| `\dv` | ビュー一覧 |
| `\df` | 関数一覧 |
| `\di` | インデックス一覧 |

---

## 🔹 データ操作 (SQL)

| コマンド | 説明 |
|-----------|------|
| `SELECT * FROM table_name;` | テーブル内容をすべて表示 |
| `INSERT INTO table_name VALUES (...);` | データを挿入 |
| `UPDATE table_name SET col = val WHERE ...;` | データ更新 |
| `DELETE FROM table_name WHERE ...;` | データ削除 |
| `COPY table_name TO '/path/file.csv' CSV HEADER;` | CSVにエクスポート |
| `COPY table_name FROM '/path/file.csv' CSV HEADER;` | CSVからインポート |

---

## 🔹 情報・設定確認

| コマンド | 説明 |
|-----------|------|
| `\du` | ユーザー（ロール）一覧 |
| `\conninfo` | 現在の接続情報を表示 |
| `\encoding` | 文字エンコーディングを表示 |
| `\timing` | クエリの実行時間を表示／非表示トグル |
| `\set` | psqlの変数設定を確認／変更 |

---

## 🔹 出力フォーマット・見やすさ

| コマンド | 説明 |
|-----------|------|
| `\x` | 表示形式を縦型モードに切り替え（オン/オフ） |
| `\pset border 2` | 表形式の枠線を表示 |
| `\a` | アライメント（整列表示）をトグル |
| `\H` | HTML形式で出力 |

---

## 🔹 ヘルプ・補助

| コマンド | 説明 |
|-----------|------|
| `\?` | psqlコマンド一覧を表示 |
| `\h` | SQLコマンドのヘルプを表示 |
| `\h SELECT` | 特定のSQLコマンドのヘルプを表示 |
| `\! コマンド` | シェルコマンドを実行（例：`\! ls`） |

---

## 🔹 便利なテクニック

| コマンド | 説明 |
|-----------|------|
| `\e` | SQLエディタを開いて編集・実行 |
| `\i ファイル.sql` | SQLファイルを実行 |
| `\watch 5 SELECT count(*) FROM logs;` | 5秒ごとにクエリを自動実行（監視） |
| `\g ファイル名` | クエリ結果をファイルに出力 |

---

## 💡 Tips

- SQLは **`;`（セミコロン）** を忘れると実行されません。  
- コマンドは **バックスラッシュ（`\`）** で始まります（psql独自）。  
- `psql -E` で起動すると、`\d` などが裏で発行している SQL が見られます（学習に便利）。

---
